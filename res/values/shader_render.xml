<?xml version="1.0" encoding="utf-8"?>
<resources>

    <string name="shader_render_scene_vs">
        uniform mat4 uMVPMatrix;
        
        attribute vec3 aPosition;
        attribute vec3 aColor;
        
        varying vec4 vColor;
        varying vec4 vPos;
        
        void main() {
            gl_Position = uMVPMatrix * vec4(aPosition, 1.0);
            vPos = gl_Position;            
            vColor.rgb = aColor;
            vColor.a = gl_Position.z / gl_Position.w;            
        }
    </string>
    <string name="shader_render_scene_fs">
        precision mediump float;
        uniform sampler2D sTexture;
        varying vec4 vColor;
        varying vec4 vPos;
        
        void main() {
            vec2 pos = vPos.xy / vPos.w;
            pos = (pos + 1.0) * 0.5;
            vec2 lightning = texture2D(sTexture, pos).rg;
            
            float ambient = 0.3;
            float diffuse = lightning.r;
            float specular = lightning.g;
            
            gl_FragColor.rgb = mix(vec3(0.0), vColor.rgb, min(ambient + diffuse, 1.0));
			gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(1.0), specular);
			gl_FragColor.a = vColor.a;
        }
    </string>
    <string name="shader_render_light_vs">
        uniform mat4 uMVMatrix;
        uniform mat4 uMVPMatrix;
        uniform mat4 uNormalMatrix;
        uniform vec3 uLightPos;
        uniform vec3 uViewDir;
        
        attribute vec3 aPosition;
        attribute vec3 aNormal;
        
        varying float vDiffuse;
        varying float vSpecular;
        varying vec4 vPos;
        
        void main() {
            gl_Position = uMVPMatrix * vec4(aPosition, 1.0);
            vec4 mvPos = uMVMatrix * vec4(aPosition, 1.0);
            
            vec3 vertexNormal = (uNormalMatrix * vec4(aNormal, 0.0)).xyz;
            vertexNormal = normalize(vertexNormal);
            vec3 lightNormal = uLightPos - mvPos.xyz;
            lightNormal = normalize(lightNormal);
            vec3 reflectionNormal = reflect(-lightNormal, vertexNormal);
            reflectionNormal = normalize(reflectionNormal);
            
            vDiffuse = dot(vertexNormal, lightNormal);
            vDiffuse = clamp(vDiffuse, 0.0, 1.0);
            vSpecular = dot(reflectionNormal, vec3(0.0, 0.0, 1.0));
            vSpecular = clamp(vSpecular, 0.0, 1.0);
            vSpecular = pow(vSpecular, 8.0);
            
            vPos = gl_Position;
        }
    </string>
    <string name="shader_render_light_fs">
        precision mediump float;
        uniform sampler2D sTexture;
        varying float vDiffuse;
        varying float vSpecular;
        varying vec4 vPos;
        
        void main() {
            vec2 pos = vPos.xy / vPos.w;
            pos = (pos + 1.0) * 0.5;
            gl_FragColor = texture2D(sTexture, pos);
            gl_FragColor.r += vDiffuse;
            gl_FragColor.g += vSpecular;
        }
    </string>

</resources>